{%- extends "base.html" -%}

{%- block title -%}Clients{%- endblock -%}

{%- set active_page = 'clients' -%}

{%- block content -%}
<div style="padding: 2rem; background-color: var(--bg-primary); min-height: calc(100vh - 60px);">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
            <div>
                <h1 style="font-size: 2rem; margin-bottom: 0.5rem;">üë• Client Management</h1>
                <p style="color: var(--text-muted);">Qu·∫£n l√Ω t√†i kho·∫£n v√† giao d·ªãch c·ªßa clients</p>
            </div>
            <button id="add-client-btn" class="btn btn-primary btn-lg">‚ûï Th√™m Client</button>
        </div>
        
        <div class="clients-grid" id="clients-container">
            <!-- Clients will be loaded here -->
        </div>
    </div>
    
    <!-- Edit/Add Client Modal -->
    <div id="clientModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h5><span id="clientModalTitle">Ch·ªânh S·ª≠a Client</span></h5>
                <button class="close-btn" onclick="Clients.closeModal()">&times;</button>
            </div>
            <div class="modal-body" style="max-height: calc(90vh - 200px); overflow-y: auto;">
                <div class="form-group">
                    <label class="form-label">T√™n Client *</label>
                    <input type="text" id="client-name" class="form-control" placeholder="Nguy·ªÖn Th√†nh Lu√¢n (T√≠ chu·ªôt)">
                </div>
                
                <div class="form-row">
                    <div class="form-group" style="flex: 1;">
                        <label class="form-label">Email</label>
                        <input type="email" id="client-email" class="form-control" placeholder="nguyenvanb@gmail.com">
                    </div>
                    <div class="form-group" style="flex: 1;">
                        <label class="form-label">S·ªë ƒëi·ªán tho·∫°i</label>
                        <input type="tel" id="client-phone" class="form-control" placeholder="123456789">
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Ghi ch√∫</label>
                    <textarea id="client-notes" class="form-control" rows="4" placeholder="Th√¥ng tin b·ªï sung v·ªÅ client..."></textarea>
                </div>
                
                <!-- Exchange Profiles Section -->
                <div class="form-section">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h6 class="section-title" style="margin: 0;">üîå Exchange Profiles</h6>
                    </div>
                    
                    <div id="exchangeProfilesList">
                        <!-- Exchange profiles will be added here -->
                    </div>
                    
                    <button class="btn btn-primary btn-block" onclick="Clients.addExchangeProfile()">
                        ‚ûï Th√™m Exchange Profile
                    </button>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-danger" onclick="Clients.closeModal()">H·ªßy</button>
                <button class="btn btn-primary" onclick="Clients.saveClient()">
                    üíæ L∆∞u Client
                </button>
            </div>
        </div>
    </div>
    
    <!-- Client Reports Page (Hidden by default) -->
    <div id="clientReportsPage" class="reports-page" style="display: none;">
        <div class="reports-header">
            <div>
                <h1 id="reportsClientName">Nguy·ªÖn Th√†nh Lu√¢n (T√≠ chu·ªôt)</h1>
                <p id="reportsClientContact">nguyenvanb@gmail.com ‚Ä¢ 123456789</p>
            </div>
            <button class="btn btn-secondary" onclick="Clients.closeReportsPage()">
                ‚Üê Back to Clients
            </button>
        </div>
        
        <div class="reports-stats">
            <div class="stat-card">
                <div class="stat-label">TOTAL TRADES</div>
                <div class="stat-value" id="reportsTotalTrades">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">WIN RATE</div>
                <div class="stat-value" id="reportsWinRate">0.0%</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">TOTAL PNL</div>
                <div class="stat-value" id="reportsTotalPnl">+0 VND</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">AVERAGE WIN</div>
                <div class="stat-value" id="reportsAvgWin">+0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">AVERAGE LOSS</div>
                <div class="stat-value" id="reportsAvgLoss">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">PROFIT FACTOR</div>
                <div class="stat-value" id="reportsProfitFactor">0.00</div>
            </div>
        </div>
        
        <div class="trade-history-section">
            <div class="trade-history-header">
                <h3>üìä Trade History</h3>
                <div class="trade-filters">
                    <button class="filter-btn active" data-filter="all">All</button>
                    <button class="filter-btn" data-filter="winning">Winning</button>
                    <button class="filter-btn" data-filter="losing">Losing</button>
                </div>
            </div>
            
            <div class="trade-history-table">
                <table>
                    <thead>
                        <tr>
                            <th>DATE</th>
                            <th>SYMBOL</th>
                            <th>SIDE</th>
                            <th>ENTRY PRICE</th>
                            <th>EXIT PRICE</th>
                            <th>VOLUME</th>
                            <th>PNL</th>
                            <th>DURATION</th>
                        </tr>
                    </thead>
                    <tbody id="tradeHistoryBody">
                        <tr>
                            <td colspan="8" style="text-align: center; padding: 40px; color: var(--text-muted);">
                                No trades found
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
{%- endblock -%}

{% block extra_js %}
    <script src="{{ url_for('static', filename='js/clients.js') }}"></script>
{% endblock %}
